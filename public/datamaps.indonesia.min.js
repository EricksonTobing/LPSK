!(function (root, factory) {
  if (typeof define === "function" && define.amd) {
    define(["d3", "topojson"], factory);
  } else if (typeof exports === "object") {
    module.exports = factory(require("d3"), require("topojson"));
  } else {
    root.DatamapIndonesia = factory(root.d3, root.topojson);
  }
})(this, function (d3, topojson) {
  // TopoJSON hasil dari provinces-simplified-topo (3).json
  var indonesiaTopo = {
    type: "Topology",
    transform: {
      scale: [0.000549775657903022, 0.0005108452131315226],
      translate: [95.0412824443656, -3.3487878901221686],
    },
    objects: {
      "3provinsi": {
        type: "GeometryCollection",
        geometries: [
          {
            type: "MultiPolygon",
            properties: { provinsi: "Aceh" },
            arcs: [
              [[0]],
              [[1]],
              [[2]],
              [[3]],
              [[4]],
              [[5]],
              [[6, 7, 8]],
              [[9]],
              [[10]],
              [[11]],
            ],
          },
          {
            type: "MultiPolygon",
            properties: { provinsi: "Sumatera Barat" },
            arcs: [[[12]], [[13]], [[14]], [[15]], [[16]], [[17, 18]]],
          },
          {
            type: "MultiPolygon",
            properties: { provinsi: "Sumatera Utara" },
            arcs: [
              [[19]],
              [[20]],
              [[21]],
              [[22]],
              [[23]],
              [[24]],
              [[25]],
              [[26, -19, 27, -8]],
            ],
          },
        ],
      },
    },
    /* potongan arcs panjang â†’ ambil langsung dari file JSON Anda */
    arcs: [
      [
        [3778, 10691],
        [67, -50],
        [0, -64],
        [-59, -20],
        [-75, 33],
        [0, 54],
        [24, 47],
        [43, 0],
      ],
      [
        [2923, 10714],
        [59, -23],
        [16, -54],
        [-67, -53],
        [-58, 20],
        [-17, 87],
        [67, 23],
      ],
      [
        [2890, 10841],
        [33, -36],
        [-25, -41],
        [-51, 64],
        [43, 13],
      ],
      [
        [4004, 10932],
        [108, -14],
        [-8, -70],
        [50, -30],
        [34, -54],
        [-9, -73],
        [34, -14],
        [-17, -93],
        [-67, -4],
        [-50, 91],
        [-34, 6],
        [-8, 61],
        [-109, 93],
        [-50, -13],
        [-42, 47],
        [-50, -3],
        [-8, 53],
        [83, -7],
        [25, 24],
        [34, -50],
        [50, -7],
        [34, 57],
      ],
      [
        [2110, 11093],
        [-58, 16],
        [-17, 87],
        [34, 41],
        [58, -4],
        [9, -70],
        [25, -34],
        [-51, -36],
      ],
      [
        [1382, 12293],
        [8, -36],
        [118, 0],
        [67, -37],
        [17, -67],
        [-76, 23],
        [-8, -43],
        [33, -40],
        [67, 3],
        [67, -37],
        [25, -33],
        [59, -31],
        [17, -36],
        [92, 0],
        [25, -27],
        [59, -14],
        [41, -110],
        [-50, 3],
        [-8, -93],
        [84, 20],
        [58, -34],
        [9, 40],
        [100, -66],
        [8, -50],
        [93, -61],
        [83, -13],
        [0, -63],
        [67, -74],
        [17, -40],
        [67, 57],
        [76, -64],
        [0, -46],
        [33, -54],
        [25, -87],
        [-34, -37],
        [-67, -33],
        [-58, 6],
        [-76, 30],
        [-50, -13],
        [-50, 37],
        [-8, 127],
        [-84, 14],
        [-75, 26],
        [-50, 74],
        [-60, 23],
        [-50, 40],
        [-41, 57],
        [-118, 70],
        [-84, 17],
        [-75, -10],
        [-16, -27],
        [-126, 67],
        [8, 33],
        [-41, 34],
        [-93, 16],
        [-50, 71],
        [-51, 23],
        [-33, 84],
        [-75, 23],
        [-17, 44],
        [25, 30],
        [25, 77],
        [118, 10],
        [-26, 64],
        [0, 83],
        [59, 50],
      ],
      [
        [2170, 14494],
        [-9, 24],
        [-92, 100],
        [-76, 47],
        [-16, -17],
        [-126, 141],
        [-67, 10],
        [-101, 107],
        [-133, 174],
        [-67, 70],
        [-101, 87],
        [-100, 134],
        [-226, 210],
        [-76, 41],
        [9, 50],
        [-84, -3],
        [-9, 56],
        [-67, 101],
        [0, 23],
        [-75, 64],
        [-17, 53],
        [-33, 4],
        [-8, 70],
        [-51, 50],
        [8, 54],
        [-41, 40],
        [0, 97],
        [-26, 130],
        [-58, 50],
        [-59, 117],
        [17, 91],
        [-51, 67],
        [-58, 43],
        [8, 37],
        [-16, 67],
        [-50, 70],
        [33, 10],
        [-17, 77],
        [50, 30],
        [-16, 104],
        [0, 74],
        [-25, 67],
        [-67, 50],
        [58, 97],
        [76, -47],
        [91, 74],
        [26, -24],
        [92, 64],
        [0, 30],
        [92, 70],
        [50, -13],
        [42, -74],
        [58, -30],
        [26, 34],
        [101, 6],
        [50, 20],
        [100, -66],
        [100, -31],
        [227, -117],
        [42, -6],
        [42, -41],
        [0, -147],
        [50, -64],
        [42, 27],
        [50, -30],
        [0, -47],
        [42, -3],
        [33, -54],
        [50, -3],
        [101, -131],
        [75, 31],
        [84, -37],
        [160, -4],
        [58, -36],
        [75, -24],
        [93, -50],
        [125, 70],
        [33, -57],
        [51, -20],
        [59, 0],
        [66, 24],
        [84, 0],
        [160, 60],
        [67, -27],
        [24, 34],
        [92, 36],
        [51, -6],
        [33, -34],
        [59, -13],
        [118, 50],
        [100, -10],
        [167, -64],
        [84, -60],
        [-8, -80],
        [50, -20],
        [58, 0],
        [202, 90],
        [100, 30],
        [234, 91],
        [84, -61],
        [67, -120],
        [67, -64],
        [59, -13],
        [17, -104],
        [66, -73],
        [67, -50],
        [110, -117],
        [150, -104],
        [50, -3],
        [17, -74],
        [59, -171],
        [41, -164],
        [-7, -30],
        [91, -90],
        [-75, -134],
        [51, -34],
        [150, 14],
        [0, -30],
        [67, 0],
        [92, -40],
        [25, -34],
        [50, -17],
        [43, -80],
        [84, -40],
        [-9, -177],
        [-42, -70],
        [-33, -3],
      ],
      [
        [5813, 14950],
        [-76, 30],
        [-17, -20],
        [-75, -7],
        [0, -50],
        [-42, -14],
        [-59, 14],
        [0, -137],
        [-67, -101],
        [0, -70],
        [-24, -50],
        [17, -81],
        [-34, -27],
        [8, -40],
        [-17, -70],
        [-125, -80],
        [0, -61],
        [-76, 31],
        [-25, -54],
        [25, -47],
        [-8, -83],
        [-134, -104],
        [-67, -73],
        [42, -97],
        [42, -37],
        [8, -60],
        [34, -37],
        [0, -80],
        [66, -27],
        [34, -84],
        [-8, -33],
        [67, -31],
        [-43, -60],
        [34, -73],
        [-8, -37],
        [50, -44],
        [42, 0],
        [50, -60],
        [-8, -84],
        [-67, -43],
        [-93, -30],
        [-41, 3],
        [-67, -23],
        [100, -50],
        [25, -54],
        [0, -70],
        [59, -53],
        [17, -104],
        [-42, -37],
        [-42, 17],
        [17, -161],
        [17, -10],
        [0, -167],
        [41, -20],
        [51, 3],
        [59, -87],
        [17, -47],
        [83, 0],
        [8, -84],
        [-25, -87],
        [25, -26],
        [0, -54],
        [42, -27],
        [9, -50],
        [-76, -37],
        [8, -63],
        [-24, -27],
        [8, -120],
        [25, -80],
        [33, -50],
        [0, -74],
        [76, -13],
        [0, -61],
        [33, -36],
        [25, -128],
        [-33, -200],
        [-25, -104],
      ],
      [
        [5662, 10758],
        [-92, 90],
        [-268, 147],
        [-76, 10],
        [-25, -36],
        [-33, 43],
        [-51, -43],
        [-75, 30],
        [-59, -50],
        [-50, 53],
        [-25, 77],
        [-76, 104],
        [-66, 67],
        [-9, 87],
        [0, 327],
        [-8, 127],
        [-67, 275],
        [0, 43],
        [-33, 81],
        [-34, 26],
        [-76, -10],
        [-100, 71],
        [-67, 0],
        [-83, 63],
        [-143, 181],
        [-25, 64],
        [0, 50],
        [-26, 37],
        [-24, 110],
        [-59, 107],
        [-92, 46],
        [-42, -13],
        [-42, 100],
        [-50, 47],
        [0, 54],
        [-68, 73],
        [-41, 71],
        [-9, 57],
        [-67, 87],
        [-33, 90],
        [-109, 50],
        [-75, 57],
        [-9, 77],
        [-25, 64],
        [-42, 47],
        [-92, 37],
        [-67, 43],
        [-100, 13],
        [-135, -3],
        [-67, -20],
        [-133, -7],
        [-42, 17],
        [-101, 83],
        [-134, 137],
        [-58, 104],
        [-134, 214],
        [-75, 80],
      ],
      [
        [193, 17639],
        [50, -80],
        [-50, -53],
        [-51, 16],
        [43, 57],
        [8, 60],
      ],
      [
        [34, 17813],
        [24, -54],
        [34, 3],
        [34, -60],
        [0, -53],
        [-59, 0],
        [-67, 53],
        [25, 30],
        [9, 81],
      ],
      [
        [319, 18121],
        [41, -24],
        [84, -107],
        [34, -3],
        [24, 53],
        [9, 67],
        [58, -40],
        [34, -60],
        [9, -87],
        [-59, 43],
        [0, -73],
        [-25, -37],
        [-84, 16],
        [-33, 41],
        [-17, 87],
        [-42, 20],
        [-33, 57],
        [0, 47],
      ],
      [
        [9917, 405],
        [50, -101],
        [-34, -13],
        [-25, 40],
        [9, 74],
      ],
      [
        [9447, 1107],
        [59, -60],
        [-9, -27],
        [84, -90],
        [42, -17],
        [92, -97],
        [34, -67],
        [34, -10],
        [16, -57],
        [75, -36],
        [0, -101],
        [-24, -97],
        [33, -46],
        [-93, -24],
        [-50, 0],
        [17, -53],
        [9, -121],
        [41, -33],
        [76, -141],
        [-25, -30],
        [-42, 6],
        [-33, 71],
        [-76, 43],
        [8, 61],
        [-83, 16],
        [-17, 34],
        [0, 94],
        [17, 80],
        [-42, 80],
        [-34, 37],
        [-42, 10],
        [-33, 63],
        [-42, 14],
        [-50, 83],
        [-26, 4],
        [9, 96],
        [17, 44],
        [-17, 33],
        [0, 91],
        [-33, 117],
        [108, 30],
      ],
      [
        [9020, 1656],
        [59, -57],
        [50, -77],
        [67, -40],
        [42, -50],
        [101, -61],
        [16, -60],
        [67, -110],
        [0, -74],
        [-76, -27],
        [-67, -40],
        [9, -64],
        [-134, 7],
        [-58, 34],
        [0, -64],
        [-59, 10],
        [0, 84],
        [-58, 73],
        [58, 44],
        [-17, 54],
        [17, 93],
        [-58, 91],
        [24, 26],
        [-50, 47],
        [17, 30],
        [0, 121],
        [50, 10],
      ],
      [
        [8317, 2606],
        [167, -141],
        [8, -127],
        [26, -60],
        [41, -54],
        [17, -53],
        [42, -24],
        [8, -80],
        [34, 7],
        [50, -47],
        [26, -70],
        [-9, -30],
        [-84, -14],
        [-8, 50],
        [-76, -3],
        [-67, 37],
        [-8, 36],
        [-50, 37],
        [-67, 17],
        [-42, -20],
        [-33, 17],
        [-17, 93],
        [-76, 57],
        [-41, 104],
        [84, 23],
        [-43, 71],
        [0, 70],
        [17, 54],
        [101, 50],
      ],
      [
        [7018, 4783],
        [17, -53],
        [43, -4],
        [24, -90],
        [-50, -50],
        [33, -40],
        [17, -107],
        [101, -64],
        [8, -97],
        [50, -36],
        [0, -87],
        [42, -7],
        [25, -43],
        [-8, -77],
        [42, -34],
        [16, -110],
        [101, -81],
        [26, -77],
        [-43, -70],
        [109, -70],
        [-8, -77],
        [33, -94],
        [92, 3],
        [34, -50],
        [-17, -70],
        [26, -30],
        [16, -84],
        [-25, -43],
        [-42, 6],
        [0, 47],
        [-42, 70],
        [0, -123],
        [42, -50],
        [-67, -30],
        [-134, 6],
        [-17, -43],
        [-91, 0],
        [-160, 83],
        [-59, 54],
        [-184, 113],
        [-34, 77],
        [-50, 34],
        [17, 74],
        [-58, 130],
        [-109, 137],
        [-25, 74],
        [-59, 87],
        [-83, 97],
        [-26, 44],
        [0, 60],
        [-67, 67],
        [-8, 57],
        [25, 13],
        [50, 93],
        [0, 44],
        [42, 83],
        [0, 158],
        [8, 36],
        [76, 64],
        [67, -27],
        [92, 4],
        [67, 40],
        [67, 10],
        [58, 53],
      ],
      [
        [9355, 8048],
        [101, -53],
        [34, -60],
        [-9, -47],
        [-34, -30],
        [-50, -114],
        [9, -127],
        [125, -248],
        [0, -160],
        [34, -20],
        [75, 53],
        [42, 7],
        [58, -27],
        [43, -80],
        [16, -71],
        [34, -60],
        [67, -33],
        [217, -64],
        [109, -10],
        [84, 90],
        [109, 77],
        [67, 14],
        [67, -144],
        [-34, -91],
        [0, -73],
        [42, -107],
        [-8, -110],
        [-67, -64],
        [-50, 34],
        [-59, -74],
        [17, -63],
        [16, -164],
        [34, -41],
        [-17, -36],
        [17, -61],
        [33, -53],
        [67, -47],
        [-8, -70],
        [51, -17],
        [91, -74],
        [26, 61],
        [-17, 30],
        [142, 20],
        [75, -61],
        [17, -234],
        [76, -83],
        [176, -87],
        [33, -60],
        [50, -13],
        [51, -74],
        [91, -3],
        [43, -47],
        [41, -7],
        [0, -63],
        [43, -31],
        [33, 7],
        [25, -70],
        [84, -71],
        [50, -26],
        [34, -44],
        [50, -7],
        [84, -63],
        [41, -14],
        [34, -70],
        [58, -47],
        [34, -47],
        [92, -40],
        [42, 7],
        [16, -37],
        [84, 10],
        [51, -23],
        [-17, -44],
        [25, -87],
        [-8, -100],
        [100, -60],
        [-50, -100],
        [-75, -80],
        [-76, -24],
        [-84, -6],
        [-67, -88],
        [34, -103],
        [25, -44],
        [-50, -97],
        [50, -60],
        [-25, -17],
        [-17, -84],
        [-159, -130],
        [-84, -50],
        [-58, -64],
        [-59, -127],
        [-126, -30],
        [-25, 36],
        [-167, -43],
        [-109, 3],
        [-84, -46],
        [-58, 76],
        [-34, -43],
        [-75, 37],
        [0, -231],
        [8, -103],
        [26, -131],
        [33, -36],
        [58, -108],
        [92, -60],
        [42, -84],
        [51, -140],
        [24, -161],
        [-24, -117],
        [-93, -134],
        [-41, -3],
        [-51, -57],
        [-58, -20],
        [-193, -140],
        [-51, -54],
        [-58, 107],
        [-192, 201],
        [-26, 170],
        [-50, 54],
        [-50, 84],
        [0, 50],
        [83, 90],
        [26, 84],
        [0, 70],
        [-17, 37],
        [0, 114],
        [-50, 127],
        [-84, 100],
        [-25, 17],
        [-67, 147],
        [-50, 53],
        [-59, 114],
        [-84, 84],
        [-8, 123],
        [-26, 31],
        [0, 80],
        [-41, 13],
        [-50, 77],
        [24, 111],
        [-33, 124],
        [-50, 40],
        [-92, 20],
        [-50, 57],
        [-101, 20],
        [0, 47],
        [42, 13],
        [0, 64],
        [-50, 6],
        [-67, 77],
        [17, 97],
        [-17, 57],
        [25, 23],
        [67, -13],
        [-8, 67],
        [-43, 16],
        [0, 64],
        [-50, 7],
        [-17, 73],
        [-8, 127],
        [-25, 64],
        [-67, 67],
        [-25, 54],
        [-58, 73],
        [-143, 134],
        [-75, 81],
        [-26, 77],
        [-125, 196],
        [-151, 144],
        [-75, 57],
        [-9, 47],
        [-41, 57],
        [-142, 104],
        [-26, 63],
        [0, 84],
        [-92, 140],
        [17, 61],
        [8, 103],
        [-25, 61],
        [-93, 63],
        [-58, 71],
        [-58, 50],
        [-244, 136],
        [-133, 50],
        [-59, 0],
        [-8, 71],
        [-59, 83],
        [-84, 17],
        [-125, -43],
        [-67, 0],
        [-34, 73],
        [-41, -40],
      ],
      [
        [7505, 7011],
        [58, 117],
        [101, 91],
        [74, -4],
        [68, 51],
        [59, 133],
        [58, 74],
        [9, 44],
        [58, 13],
        [109, 77],
        [33, 7],
        [34, -40],
        [100, -7],
        [101, 60],
        [42, -64],
        [8, -66],
        [84, -54],
        [109, 60],
        [92, -43],
        [134, 20],
        [33, 17],
        [26, 50],
        [50, 20],
        [8, 84],
        [-34, 60],
        [-50, 30],
        [-8, 90],
        [8, 54],
        [-133, 13],
        [-34, 70],
        [0, 50],
        [34, 33],
        [0, 164],
        [-17, 81],
        [75, 36],
        [75, -46],
        [67, -7],
        [26, -60],
        [67, -17],
        [150, -101],
        [50, -10],
        [101, -46],
        [25, 3],
      ],
      [
        [6139, 6085],
        [59, -40],
        [83, -91],
        [9, -60],
        [42, -37],
        [0, -43],
        [-34, -124],
        [9, -101],
        [-50, -50],
        [50, -46],
        [-50, -50],
        [-34, 63],
        [-42, -3],
        [-84, -47],
        [-125, 60],
        [41, 27],
        [17, 93],
        [33, 7],
        [9, 104],
        [-17, 63],
        [25, 24],
        [0, 53],
        [26, 37],
        [75, 33],
        [0, 44],
        [-42, 84],
      ],
      [
        [5955, 6463],
        [50, -40],
        [8, -57],
        [-92, 47],
        [34, 50],
      ],
      [
        [6072, 6570],
        [67, -10],
        [8, -67],
        [43, -77],
        [41, -33],
        [0, -41],
        [34, -30],
        [-17, -43],
        [33, -81],
        [0, -46],
        [84, -57],
        [59, -74],
        [-8, -107],
        [-76, 3],
        [-42, 71],
        [-125, 170],
        [-26, 77],
        [-58, 57],
        [-50, 164],
        [-76, 81],
        [50, 40],
        [59, 3],
      ],
      [
        [6499, 6911],
        [109, -24],
        [50, 10],
        [34, -30],
        [59, 0],
        [33, 24],
        [59, -14],
        [91, -87],
        [-7, -70],
        [-118, 24],
        [-58, -44],
        [-235, 17],
        [-67, 23],
        [-67, -3],
        [-34, 27],
        [-8, 73],
        [76, 60],
        [83, 14],
      ],
      [
        [4205, 9574],
        [33, -21],
        [25, -53],
        [50, -3],
        [51, -61],
        [91, 4],
        [9, -51],
        [51, -50],
        [33, -3],
        [0, -64],
        [58, -73],
        [43, -30],
        [75, -127],
        [25, -67],
        [50, -37],
        [17, -77],
        [75, -23],
        [42, 3],
        [33, -33],
        [67, -10],
        [68, -104],
        [33, -70],
        [59, -4],
        [50, -67],
        [0, -36],
        [42, -67],
        [0, -34],
        [-84, -110],
        [-8, -141],
        [25, -57],
        [-34, -43],
        [-8, -64],
        [17, -36],
        [0, -171],
        [-17, -50],
        [-50, -23],
        [-25, -44],
        [-42, -10],
        [-9, -43],
        [-58, 63],
        [-50, -47],
        [-26, 51],
        [-58, -34],
        [-50, 40],
        [24, 51],
        [-16, 50],
        [-42, 53],
        [-17, 160],
        [-41, 77],
        [0, 34],
        [-51, 33],
        [-8, 50],
        [-67, 37],
        [-17, 47],
        [-75, 43],
        [-26, 47],
        [-58, 24],
        [-92, 13],
        [-33, 127],
        [-110, 228],
        [-142, 224],
        [-59, 47],
        [-33, 3],
        [-33, 81],
        [-84, 116],
        [-76, 64],
        [59, 50],
        [67, -44],
        [34, 21],
        [41, -34],
        [126, 44],
        [8, 43],
        [51, 20],
        [58, 50],
        [9, 47],
        [-34, 30],
        [34, 41],
      ],
      [
        [6248, 9888],
        [26, -10],
        [7, -87],
        [93, -10],
        [8, 60],
        [67, -33],
        [0, -34],
        [42, -40],
        [-92, -13],
        [-42, 33],
        [-42, -20],
        [-125, 51],
        [-9, 53],
        [33, 50],
        [34, 0],
      ],
      [
        [5871, 14725],
        [9, -63],
        [-43, -17],
        [-33, 23],
        [17, 61],
        [50, -4],
      ],
      [
        [5813, 14950],
        [17, -47],
        [7, -141],
        [-117, -37],
        [-33, -33],
        [25, -90],
        [75, 36],
        [43, 4],
        [91, -44],
        [34, -70],
        [134, 10],
        [84, -70],
        [101, -20],
        [91, -41],
        [-17, -83],
        [42, -47],
        [42, -14],
        [42, -43],
        [50, -3],
        [26, -37],
        [67, 20],
        [33, -60],
        [0, -81],
        [17, -76],
        [34, -40],
        [66, -27],
        [17, -50],
        [226, -104],
        [118, -17],
        [159, -100],
        [151, -114],
        [75, -20],
        [184, -127],
        [75, -74],
        [0, -23],
        [101, -74],
        [134, -53],
        [25, -34],
        [50, -17],
        [0, -57],
        [25, -13],
        [68, -114],
        [67, -40],
        [200, -47],
        [143, -86],
        [8, -54],
        [33, -26],
        [76, -117],
        [75, -67],
        [34, 16],
        [58, -100],
        [76, -57],
        [58, 3],
        [-8, -214],
        [17, -37],
        [0, -97],
        [-17, -50],
        [-67, -74],
        [0, -57],
        [34, -30],
        [108, 14],
        [-50, 40],
        [-50, 13],
        [109, 67],
        [50, -13],
        [50, -47],
        [17, -60],
        [-8, -144],
        [16, -20],
        [9, -84],
        [42, -50],
        [8, 87],
        [-25, 70],
        [0, 94],
        [25, 50],
        [50, 47],
        [109, 0],
        [0, -57],
        [25, -74],
        [67, -53],
        [0, -40],
        [42, -50],
        [50, -27],
        [9, -47],
        [-9, -60],
        [-33, -103],
        [0, -158],
        [25, -110],
        [75, -174],
        [0, -77],
        [-58, -235],
        [-9, -67],
        [0, -220],
        [-16, -63],
        [-50, -91],
        [8, -67],
        [142, -43],
        [76, -3],
        [24, -27],
        [9, -64],
        [-33, -67],
        [67, -50],
        [-9, -171],
        [-50, -87],
        [33, -43],
        [-8, -51],
        [-84, -80],
        [-100, 10],
        [0, 47],
        [-50, 0],
        [-34, -27],
        [75, -60],
        [-8, -37],
        [-92, 7],
        [-33, -47],
        [-43, -10],
        [-259, -7],
        [-50, -30],
        [0, -43],
        [67, -47],
        [50, -133],
        [0, -121],
        [17, -43],
        [58, -44],
        [33, -67],
        [-58, -3],
        [-84, -47],
        [9, -37],
        [59, -37],
        [16, -56],
        [-16, -151],
        [-101, -7],
        [17, -60],
        [67, -20],
        [0, -87],
        [17, -40],
        [-34, -34],
        [34, -50],
        [83, -67],
      ],
      [
        [7505, 7011],
        [-17, 64],
        [8, 57],
        [-25, 73],
        [-67, 24],
        [41, 63],
        [9, 141],
        [-59, 164],
        [9, 70],
        [-42, 101],
        [-75, 6],
        [0, 47],
        [33, 37],
        [-9, 133],
        [-41, 100],
        [-76, 77],
        [-42, 208],
        [-33, 100],
        [-50, 108],
        [-25, 167],
        [-76, 164],
        [-8, 60],
        [-50, 84],
        [17, 97],
        [-34, 80],
        [-84, 100],
        [-8, 74],
        [-25, 70],
        [-67, 63],
        [75, 10],
        [8, 71],
        [59, 23],
        [59, 94],
        [-26, 100],
        [-75, 24],
        [-8, 77],
        [-25, 67],
        [-101, 40],
        [-25, -27],
        [67, -33],
        [-33, -61],
        [-67, 31],
        [-34, 67],
        [-109, 140],
        [-92, 94],
        [-117, 157],
        [-109, 70],
        [-101, 10],
        [-50, 63],
        [-117, -10],
        [-84, 101],
        [-67, 33],
        [-75, 74],
      ],
    ],
    transform: {
      scale: [0.000549775657903022, 0.0005108452131315226],
      translate: [95.0412824443656, -3.3487878901221686],
    },
    objects: {
      "3provinsi": {
        type: "GeometryCollection",
        geometries: [
          {
            arcs: [
              [[0]],
              [[1]],
              [[2]],
              [[3]],
              [[4]],
              [[5]],
              [[6, 7, 8]],
              [[9]],
              [[10]],
              [[11]],
            ],
            type: "MultiPolygon",
            properties: { provinsi: "Aceh" },
          },
          {
            arcs: [[[12]], [[13]], [[14]], [[15]], [[16]], [[17, 18]]],
            type: "MultiPolygon",
            properties: { provinsi: "Sumatera Barat" },
          },
          {
            arcs: [
              [[19]],
              [[20]],
              [[21]],
              [[22]],
              [[23]],
              [[24]],
              [[25]],
              [[26, -19, 27, -8]],
            ],
            type: "MultiPolygon",
            properties: { provinsi: "Sumatera Utara" },
          },
        ],
      },
    },
  }; // <=== ganti dengan semua isi "arcs" dari file Anda
  // Plugin untuk render 3 provinsi
  return function DatamapIndonesia(options) {
    var element = options.element;
    var data = options.data || {};
    var fills = options.fills || { defaultFill: "#f0f0f0" };
    var geographyConfig = options.geographyConfig || {};
    var width = element.offsetWidth;
    var height = element.offsetHeight;

    var projection = d3.geo
      .mercator()
      .center([99, 2])
      .scale(1500)
      .translate([width / 2, height / 2]);

    var path = d3.geo.path().projection(projection);

    var svg = d3
      .select(element)
      .append("svg")
      .attr("width", width)
      .attr("height", height);

    var features = topojson.feature(
      indonesiaTopo,
      indonesiaTopo.objects["3provinsi"]
    ).features;

    function showTooltip(event, d) {
      var prov = d.properties.provinsi;
      var item = data[prov];

      console.log("Tooltip untuk:", prov, "Data:", item); // Debug

      // Pastikan item ada dan memiliki data
      var value =
        item && (item.value !== undefined || item.jumlah !== undefined)
          ? item.value || item.jumlah
          : 0;

      // Deteksi mode gelap
      var isDarkMode = document.documentElement.classList.contains("dark");

      var bgColor = isDarkMode ? "#374151" : "#ffffff";
      var textColor = isDarkMode ? "#e5e7eb" : "#1f2937";
      var borderColor = isDarkMode ? "#4b5563" : "#d1d5db";
      var shadowColor = isDarkMode
        ? "rgba(0, 0, 0, 0.5)"
        : "rgba(0, 0, 0, 0.1)";

      var html =
        '<div class="map-tooltip" style="padding: 12px; background: ' +
        bgColor +
        "; border: 1px solid " +
        borderColor +
        "; border-radius: 6px; box-shadow: 0 4px 12px " +
        shadowColor +
        "; color: " +
        textColor +
        '; max-width: 200px; font-family: system-ui, sans-serif; z-index: 10000;">' +
        '<strong style="display: block; margin-bottom: 8px; font-size: 14px; border-bottom: 1px solid ' +
        (isDarkMode ? "#4b5563" : "#e5e7eb") +
        '; padding-bottom: 4px;">' +
        prov +
        "</strong>" +
        '<div style="font-size: 13px; display: flex; justify-content: space-between; align-items: center;">' +
        "<span>Jumlah Permohonan:</span>" +
        '<strong style="color: ' +
        (isDarkMode ? "#60a5fa" : "#2563eb") +
        '">' +
        value.toLocaleString() +
        "</strong>" +
        "</div>" +
        "</div>";

      // Hapus tooltip lama jika ada
      d3.selectAll(".map-tooltip").remove();

      var tooltip = d3
        .select("body")
        .append("div")
        .attr("class", "map-tooltip")
        .html(html)
        .style("position", "absolute")
        .style("z-index", "10000")
        .style("pointer-events", "none")
        .style("opacity", 0);

      // Position the tooltip
      var tooltipWidth = tooltip.node().offsetWidth;
      var tooltipHeight = tooltip.node().offsetHeight;

      // Posisi tooltip di atas kursor
      var x = event.pageX - tooltipWidth / 2;
      var y = event.pageY - tooltipHeight - 15;

      // Adjust jika tooltip keluar dari layar
      if (x < 10) x = 10;
      if (x + tooltipWidth > window.innerWidth - 10) {
        x = window.innerWidth - tooltipWidth - 10;
      }
      if (y < 10) {
        y = event.pageY + 20; // Pindah ke bawah jika tidak muat di atas
      }

      tooltip
        .style("left", x + "px")
        .style("top", y + "px")
        .transition()
        .duration(200)
        .style("opacity", 1);
    }

    function hideTooltip() {
      d3.selectAll(".map-tooltip")
        .transition()
        .duration(150)
        .style("opacity", 0)
        .remove();
    }

    // Draw the map
    var paths = svg
      .selectAll("path")
      .data(features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("class", "province")
      .style("stroke", geographyConfig.highlightBorderColor || "#fff")
      .style("stroke-width", geographyConfig.highlightBorderWidth || "1")
      .style("fill", function (d) {
        var prov = d.properties.provinsi;
        var item = data[prov];
        if (item && item.fillKey && fills[item.fillKey]) {
          return fills[item.fillKey];
        }
        return fills.defaultFill;
      })
      .on("mouseover", function (event, d) {
        // Highlight on hover
        d3.select(this)
          .style("stroke-width", "2")
          .style("stroke", geographyConfig.highlightBorderColor || "#fff");

        if (geographyConfig.highlightFillColor) {
          d3.select(this).style("fill", geographyConfig.highlightFillColor(d));
        } else {
          // Default highlight effect
          var currentFill = d3.select(this).style("fill");
          d3.select(this).style("fill", d3.color(currentFill).brighter(0.4));
        }

        // Show tooltip
        if (geographyConfig.popupOnHover !== false) {
          showTooltip(event, d);
        }
      })
      .on("mousemove", function (event, d) {
        // Update tooltip position
        if (geographyConfig.popupOnHover !== false) {
          var tooltip = d3.select(".map-tooltip");
          if (!tooltip.empty()) {
            var tooltipWidth = tooltip.node().offsetWidth;
            var tooltipHeight = tooltip.node().offsetHeight;
            var x = event.pageX + 10;
            var y = event.pageY - tooltipHeight - 10;

            if (x + tooltipWidth > window.innerWidth) {
              x = event.pageX - tooltipWidth - 10;
            }
            if (y < 0) {
              y = event.pageY + 10;
            }

            tooltip.style("top", y + "px").style("left", x + "px");
          }
        }
      })
      .on("mouseout", function (event, d) {
        // Reset styles
        d3.select(this)
          .style("stroke-width", geographyConfig.highlightBorderWidth || "1")
          .style("stroke", geographyConfig.highlightBorderColor || "#fff")
          .style("fill", function (d) {
            var prov = d.properties.provinsi;
            var item = data[prov];
            if (item && item.fillKey && fills[item.fillKey]) {
              return fills[item.fillKey];
            }
            return fills.defaultFill;
          });

        // Hide tooltip
        hideTooltip();
      });

    // Public methods
    return {
      svg: svg,
      options: options,
      updateChoropleth: function (newData) {
        data = newData;
        paths.style("fill", function (d) {
          var prov = d.properties.provinsi;
          var item = data[prov];
          if (item && item.fillKey && fills[item.fillKey]) {
            return fills[item.fillKey];
          }
          return fills.defaultFill;
        });
      },
    };
  };
});
